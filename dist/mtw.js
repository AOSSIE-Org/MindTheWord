!function(e){function r(e,r,o){return 4===arguments.length?t.apply(this,arguments):void n(e,{declarative:!0,deps:r,declare:o})}function t(e,r,t,o){n(e,{declarative:!1,deps:r,executingRequire:t,execute:o})}function n(e,r){r.name=e,e in v||(v[e]=r),r.normalizedDeps=r.deps}function o(e,r){if(r[e.groupIndex]=r[e.groupIndex]||[],-1==g.call(r[e.groupIndex],e)){r[e.groupIndex].push(e);for(var t=0,n=e.normalizedDeps.length;n>t;t++){var a=e.normalizedDeps[t],u=v[a];if(u&&!u.evaluated){var d=e.groupIndex+(u.declarative!=e.declarative);if(void 0===u.groupIndex||u.groupIndex<d){if(void 0!==u.groupIndex&&(r[u.groupIndex].splice(g.call(r[u.groupIndex],u),1),0==r[u.groupIndex].length))throw new TypeError("Mixed dependency cycle detected");u.groupIndex=d}o(u,r)}}}}function a(e){var r=v[e];r.groupIndex=0;var t=[];o(r,t);for(var n=!!r.declarative==t.length%2,a=t.length-1;a>=0;a--){for(var u=t[a],i=0;i<u.length;i++){var s=u[i];n?d(s):l(s)}n=!n}}function u(e){return y[e]||(y[e]={name:e,dependencies:[],exports:{},importers:[]})}function d(r){if(!r.module){var t=r.module=u(r.name),n=r.module.exports,o=r.declare.call(e,function(e,r){if(t.locked=!0,"object"==typeof e)for(var o in e)n[o]=e[o];else n[e]=r;for(var a=0,u=t.importers.length;u>a;a++){var d=t.importers[a];if(!d.locked)for(var i=0;i<d.dependencies.length;++i)d.dependencies[i]===t&&d.setters[i](n)}return t.locked=!1,r},r.name);t.setters=o.setters,t.execute=o.execute;for(var a=0,i=r.normalizedDeps.length;i>a;a++){var l,s=r.normalizedDeps[a],c=v[s],f=y[s];f?l=f.exports:c&&!c.declarative?l=c.esModule:c?(d(c),f=c.module,l=f.exports):l=p(s),f&&f.importers?(f.importers.push(t),t.dependencies.push(f)):t.dependencies.push(null),t.setters[a]&&t.setters[a](l)}}}function i(e){var r,t=v[e];if(t)t.declarative?f(e,[]):t.evaluated||l(t),r=t.module.exports;else if(r=p(e),!r)throw new Error("Unable to load dependency "+e+".");return(!t||t.declarative)&&r&&r.__useDefault?r.default:r}function l(r){if(!r.module){var t={},n=r.module={exports:t,id:r.name};if(!r.executingRequire)for(var o=0,a=r.normalizedDeps.length;a>o;o++){var u=r.normalizedDeps[o],d=v[u];d&&l(d)}r.evaluated=!0;var c=r.execute.call(e,function(e){for(var t=0,n=r.deps.length;n>t;t++)if(r.deps[t]==e)return i(r.normalizedDeps[t]);throw new TypeError("Module "+e+" not declared as a dependency.")},t,n);c&&(n.exports=c),t=n.exports,t&&t.__esModule?r.esModule=t:r.esModule=s(t)}}function s(r){var t={};if(("object"==typeof r||"function"==typeof r)&&r!==e)if(m)for(var n in r)"default"!==n&&c(t,r,n);else{var o=r&&r.hasOwnProperty;for(var n in r)"default"===n||o&&!r.hasOwnProperty(n)||(t[n]=r[n])}return t.default=r,x(t,"__useDefault",{value:!0}),t}function c(e,r,t){try{var n;(n=Object.getOwnPropertyDescriptor(r,t))&&x(e,t,n)}catch(o){return e[t]=r[t],!1}}function f(r,t){var n=v[r];if(n&&!n.evaluated&&n.declarative){t.push(r);for(var o=0,a=n.normalizedDeps.length;a>o;o++){var u=n.normalizedDeps[o];-1==g.call(t,u)&&(v[u]?f(u,t):p(u))}n.evaluated||(n.evaluated=!0,n.module.execute.call(e))}}function p(e){if(I[e])return I[e];if("@node/"==e.substr(0,6))return D(e.substr(6));var r=v[e];if(!r)throw"Module "+e+" not present.";return a(e),f(e,[]),v[e]=void 0,r.declarative&&x(r.module.exports,"__esModule",{value:!0}),I[e]=r.declarative?r.module.exports:r.esModule}var v={},g=Array.prototype.indexOf||function(e){for(var r=0,t=this.length;t>r;r++)if(this[r]===e)return r;return-1},m=!0;try{Object.getOwnPropertyDescriptor({a:0},"a")}catch(h){m=!1}var x;!function(){try{Object.defineProperty({},"a",{})&&(x=Object.defineProperty)}catch(e){x=function(e,r,t){try{e[r]=t.value||t.get.call(e)}catch(n){}}}}();var y={},D="undefined"!=typeof System&&System._nodeRequire||"undefined"!=typeof require&&require.resolve&&"undefined"!=typeof process&&require,I={"@empty":{}};return function(e,n,o,a){return function(u){u(function(u){for(var d={_nodeRequire:D,register:r,registerDynamic:t,get:p,set:function(e,r){I[e]=r},newModule:function(e){return e}},i=0;i<n.length;i++)(function(e,r){r&&r.__esModule?I[e]=r:I[e]=s(r)})(n[i],arguments[i]);a(d);var l=p(e[0]);if(e.length>1)for(var i=1;i<e.length;i++)p(e[i]);return o?l.default:l})}}}("undefined"!=typeof self?self:global)(["1"],[],!1,function($__System){this.require,this.exports,this.module;$__System.registerDynamic("2",["3"],!0,function($__require,exports,module){var defined=$__require("3");return module.exports=function(it){return Object(defined(it))},module.exports}),$__System.registerDynamic("4",["5","6","7"],!0,function($__require,exports,module){var $export=$__require("5"),core=$__require("6"),fails=$__require("7");return module.exports=function(KEY,exec){var fn=(core.Object||{})[KEY]||Object[KEY],exp={};exp[KEY]=exec(fn),$export($export.S+$export.F*fails(function(){fn(1)}),"Object",exp)},module.exports}),$__System.registerDynamic("8",["2","4"],!0,function($__require,exports,module){var toObject=$__require("2");return $__require("4")("keys",function($keys){return function(it){return $keys(toObject(it))}}),module.exports}),$__System.registerDynamic("9",["8","6"],!0,function($__require,exports,module){return $__require("8"),module.exports=$__require("6").Object.keys,module.exports}),$__System.registerDynamic("a",["9"],!0,function($__require,exports,module){return module.exports={default:$__require("9"),__esModule:!0},module.exports}),$__System.register("b",["d","e","f","c"],function(_export){var _createClass,_classCallCheck,_Promise,http,YandexTranslate;return{setters:[function(_d){_createClass=_d.default},function(_e){_classCallCheck=_e.default},function(_f){_Promise=_f.default},function(_c){http=_c.http}],execute:function(){"use strict";YandexTranslate=function(){function YandexTranslate(key,srcLang,targetLang){_classCallCheck(this,YandexTranslate),this.key=key,this.srcLang=srcLang,this.targetLang=targetLang,this.url="https://translate.yandex.net/api/v1.5/tr.json/translate?key="+this.key}return _createClass(YandexTranslate,[{key:"getTranslations",value:function(words){var _this=this,promise=new _Promise(function(resolve,reject){_this.url+="&lang="+_this.srcLang+"-"+_this.targetLang;for(var word in words)_this.url+="&text="+word.trim(" ");http(_this.url).get().then(function(data){var tMap=_this.mapTranslations(JSON.parse(data),words);resolve(tMap)}).catch(function(e){reject(e)})});return promise}},{key:"mapTranslations",value:function(data,words){var tMap={},i=0,translatedWords=data.text;for(var word in words)tMap[word]=translatedWords[i],i++;return tMap}},{key:"translateSentence",value:function(text){var _this2=this,promise=new _Promise(function(resolve,reject){_this2.url+="&lang="+_this2.srcLang+"-"+_this2.targetLang,_this2.url+="&text="+text,http(_this2.url).get().then(function(data){resolve(JSON.parse(data).text[0])}).catch(function(e){reject(e)})});return promise}}]),YandexTranslate}(),_export("YandexTranslate",YandexTranslate)}}}),$__System.register("10",["d","e","f","c"],function(_export){var _createClass,_classCallCheck,_Promise,http,BingTranslate;return{setters:[function(_d){_createClass=_d.default},function(_e){_classCallCheck=_e.default},function(_f){_Promise=_f.default},function(_c){http=_c.http}],execute:function(){"use strict";BingTranslate=function(){function BingTranslate(key,srcLang,targetLang){_classCallCheck(this,BingTranslate),this.srcLang=srcLang,this.targetLang=targetLang,this.url="https://api.microsofttranslator.com/V2/Http.svc/TranslateArray",this.authUrl="https://datamarket.accesscontrol.windows.net/v2/OAuth2-13",this.authData={grant_type:"client_credentials",scope:"http://api.microsofttranslator.com",client_id:key.clientId,client_secret:key.clientSecret}}return _createClass(BingTranslate,[{key:"getTranslations",value:function(words){var _this=this,promise=new _Promise(function(resolve,reject){var payload=_this.formPayload(words),headers={"content-type":"application/x-www-form-urlencoded"};http(_this.authUrl).post(_this.authData,headers).then(function(data){headers={Authorization:"Bearer "+JSON.parse(data).access_token,"content-type":"application/xml"},http(_this.url).post(payload,headers).then(function(res){var translations=_this.filterTranslations(res),tMap=_this.mapTranslations(translations,words);resolve(tMap)}).catch(function(e){reject(e)})}).catch(function(e){reject(e)})});return promise}},{key:"formPayload",value:function(words){var payload="<TranslateArrayRequest><AppId></AppId><From>"+this.srcLang+"</From><Texts>";for(var word in words)payload+='<string xmlns="http://schemas.microsoft.com/2003/10/Serialization/Arrays">'+word+"</string>";return payload+="</Texts><To>"+this.targetLang+"</To></TranslateArrayRequest>",{payload:payload,xml:!0}}},{key:"filterTranslations",value:function(res,words){var xmlDoc=this.parseXML(res),elements=xmlDoc.getElementsByTagName("TranslatedText"),translations=[];for(var i in elements)translations.push(elements[i].innerHTML);return translations}},{key:"parseXML",value:function(xmlStr){return(new window.DOMParser).parseFromString(xmlStr,"text/xml")}},{key:"mapTranslations",value:function(translations,words){var tMap={},i=0,translatedWords=translations;for(var word in words)tMap[word]=translatedWords[i],i++;return tMap}},{key:"translateSentence",value:function(text){var _this2=this,promise=new _Promise(function(resolve,reject){_this2.url="http://api.microsofttranslator.com/V2/Http.svc/Translate",_this2.url+="?appId",_this2.url+="&from="+_this2.srcLang,_this2.url+="&to="+_this2.targetLang,_this2.url+="&text="+text;var headers={"content-type":"application/x-www-form-urlencoded"};http(_this2.authUrl).post(_this2.authData,headers).then(function(data){headers={Authorization:"Bearer "+JSON.parse(data).access_token},http(_this2.url).get({},headers).then(function(res){var xml=_this2.parseXML(res),sentence=xml.getElementsByTagName("string")[0].innerHTML;resolve(sentence)}).catch(function(e){reject(e)})})});return promise}}]),BingTranslate}(),_export("BingTranslate",BingTranslate)}}}),$__System.registerDynamic("11",["12"],!0,function($__require,exports,module){var $=$__require("12");return module.exports=function(it,key,desc){return $.setDesc(it,key,desc)},module.exports}),$__System.registerDynamic("13",["11"],!0,function($__require,exports,module){return module.exports={default:$__require("11"),__esModule:!0},module.exports}),$__System.registerDynamic("d",["13"],!0,function($__require,exports,module){"use strict";var _Object$defineProperty=$__require("13").default;return exports.default=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),_Object$defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),exports.__esModule=!0,module.exports}),$__System.registerDynamic("e",[],!0,function($__require,exports,module){"use strict";return exports.default=function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")},exports.__esModule=!0,module.exports}),$__System.registerDynamic("14",[],!0,function($__require,exports,module){return module.exports}),$__System.registerDynamic("15",["16","3"],!0,function($__require,exports,module){var toInteger=$__require("16"),defined=$__require("3");return module.exports=function(TO_STRING){return function(that,pos){var a,b,s=String(defined(that)),i=toInteger(pos),l=s.length;return i<0||i>=l?TO_STRING?"":void 0:(a=s.charCodeAt(i),a<55296||a>56319||i+1===l||(b=s.charCodeAt(i+1))<56320||b>57343?TO_STRING?s.charAt(i):a:TO_STRING?s.slice(i,i+2):(a-55296<<10)+(b-56320)+65536)}},module.exports}),$__System.registerDynamic("17",["15","18"],!0,function($__require,exports,module){"use strict";var $at=$__require("15")(!0);return $__require("18")(String,"String",function(iterated){this._t=String(iterated),this._i=0},function(){var point,O=this._t,index=this._i;return index>=O.length?{value:void 0,done:!0}:(point=$at(O,index),this._i+=point.length,{value:point,done:!1})}),module.exports}),$__System.registerDynamic("19",[],!0,function($__require,exports,module){return module.exports=function(){},module.exports}),$__System.registerDynamic("1a",[],!0,function($__require,exports,module){return module.exports=function(done,value){return{value:value,done:!!done}},module.exports}),$__System.registerDynamic("1b",["1c"],!0,function($__require,exports,module){var cof=$__require("1c");return module.exports=Object("z").propertyIsEnumerable(0)?Object:function(it){return"String"==cof(it)?it.split(""):Object(it)},module.exports}),$__System.registerDynamic("3",[],!0,function($__require,exports,module){return module.exports=function(it){if(void 0==it)throw TypeError("Can't call method on  "+it);return it},module.exports}),$__System.registerDynamic("1d",["1b","3"],!0,function($__require,exports,module){var IObject=$__require("1b"),defined=$__require("3");return module.exports=function(it){return IObject(defined(it))},module.exports}),$__System.registerDynamic("1e",["12","1f","20","21","22"],!0,function($__require,exports,module){"use strict";var $=$__require("12"),descriptor=$__require("1f"),setToStringTag=$__require("20"),IteratorPrototype={};return $__require("21")(IteratorPrototype,$__require("22")("iterator"),function(){return this}),module.exports=function(Constructor,NAME,next){Constructor.prototype=$.create(IteratorPrototype,{next:descriptor(1,next)}),setToStringTag(Constructor,NAME+" Iterator")},module.exports}),$__System.registerDynamic("18",["23","5","24","21","25","26","1e","20","12","22"],!0,function($__require,exports,module){"use strict";var LIBRARY=$__require("23"),$export=$__require("5"),redefine=$__require("24"),hide=$__require("21"),has=$__require("25"),Iterators=$__require("26"),$iterCreate=$__require("1e"),setToStringTag=$__require("20"),getProto=$__require("12").getProto,ITERATOR=$__require("22")("iterator"),BUGGY=!([].keys&&"next"in[].keys()),FF_ITERATOR="@@iterator",KEYS="keys",VALUES="values",returnThis=function(){return this};return module.exports=function(Base,NAME,Constructor,next,DEFAULT,IS_SET,FORCED){$iterCreate(Constructor,NAME,next);var methods,key,getMethod=function(kind){if(!BUGGY&&kind in proto)return proto[kind];switch(kind){case KEYS:return function(){return new Constructor(this,kind)};case VALUES:return function(){return new Constructor(this,kind)}}return function(){return new Constructor(this,kind)}},TAG=NAME+" Iterator",DEF_VALUES=DEFAULT==VALUES,VALUES_BUG=!1,proto=Base.prototype,$native=proto[ITERATOR]||proto[FF_ITERATOR]||DEFAULT&&proto[DEFAULT],$default=$native||getMethod(DEFAULT);if($native){var IteratorPrototype=getProto($default.call(new Base));setToStringTag(IteratorPrototype,TAG,!0),!LIBRARY&&has(proto,FF_ITERATOR)&&hide(IteratorPrototype,ITERATOR,returnThis),DEF_VALUES&&$native.name!==VALUES&&(VALUES_BUG=!0,$default=function(){return $native.call(this)})}if(LIBRARY&&!FORCED||!BUGGY&&!VALUES_BUG&&proto[ITERATOR]||hide(proto,ITERATOR,$default),Iterators[NAME]=$default,Iterators[TAG]=returnThis,DEFAULT)if(methods={values:DEF_VALUES?$default:getMethod(VALUES),keys:IS_SET?$default:getMethod(KEYS),entries:DEF_VALUES?getMethod("entries"):$default},FORCED)for(key in methods)key in proto||redefine(proto,key,methods[key]);else $export($export.P+$export.F*(BUGGY||VALUES_BUG),NAME,methods);return methods},module.exports}),$__System.registerDynamic("27",["19","1a","26","1d","18"],!0,function($__require,exports,module){"use strict";var addToUnscopables=$__require("19"),step=$__require("1a"),Iterators=$__require("26"),toIObject=$__require("1d");return module.exports=$__require("18")(Array,"Array",function(iterated,kind){this._t=toIObject(iterated),this._i=0,this._k=kind},function(){var O=this._t,kind=this._k,index=this._i++;return!O||index>=O.length?(this._t=void 0,step(1)):"keys"==kind?step(0,index):"values"==kind?step(0,O[index]):step(0,[index,O[index]])},"values"),Iterators.Arguments=Iterators.Array,addToUnscopables("keys"),addToUnscopables("values"),addToUnscopables("entries"),module.exports}),$__System.registerDynamic("28",["27","26"],!0,function($__require,exports,module){$__require("27");var Iterators=$__require("26");return Iterators.NodeList=Iterators.HTMLCollection=Iterators.Array,module.exports}),$__System.registerDynamic("23",[],!0,function($__require,exports,module){return module.exports=!0,module.exports}),$__System.registerDynamic("5",["29","6","2a"],!0,function($__require,exports,module){var global=this,global=$__require("29"),core=$__require("6"),ctx=$__require("2a"),PROTOTYPE="prototype",$export=function(type,name,source){var key,own,out,IS_FORCED=type&$export.F,IS_GLOBAL=type&$export.G,IS_STATIC=type&$export.S,IS_PROTO=type&$export.P,IS_BIND=type&$export.B,IS_WRAP=type&$export.W,exports=IS_GLOBAL?core:core[name]||(core[name]={}),target=IS_GLOBAL?global:IS_STATIC?global[name]:(global[name]||{})[PROTOTYPE];IS_GLOBAL&&(source=name);for(key in source)own=!IS_FORCED&&target&&key in target,own&&key in exports||(out=own?target[key]:source[key],exports[key]=IS_GLOBAL&&"function"!=typeof target[key]?source[key]:IS_BIND&&own?ctx(out,global):IS_WRAP&&target[key]==out?function(C){var F=function(param){return this instanceof C?new C(param):C(param)};return F[PROTOTYPE]=C[PROTOTYPE],F}(out):IS_PROTO&&"function"==typeof out?ctx(Function.call,out):out,IS_PROTO&&((exports[PROTOTYPE]||(exports[PROTOTYPE]={}))[key]=out))};return $export.F=1,$export.G=2,$export.S=4,$export.P=8,$export.B=16,$export.W=32,module.exports=$export,module.exports}),$__System.registerDynamic("2b",[],!0,function($__require,exports,module){return module.exports=function(it,Constructor,name){if(!(it instanceof Constructor))throw TypeError(name+": use the 'new' operator!");return it},module.exports}),$__System.registerDynamic("2c",["2d"],!0,function($__require,exports,module){var anObject=$__require("2d");return module.exports=function(iterator,fn,value,entries){try{return entries?fn(anObject(value)[0],value[1]):fn(value)}catch(e){var ret=iterator.return;throw void 0!==ret&&anObject(ret.call(iterator)),e}},module.exports}),$__System.registerDynamic("2e",["26","22"],!0,function($__require,exports,module){var Iterators=$__require("26"),ITERATOR=$__require("22")("iterator"),ArrayProto=Array.prototype;return module.exports=function(it){return void 0!==it&&(Iterators.Array===it||ArrayProto[ITERATOR]===it)},module.exports}),$__System.registerDynamic("16",[],!0,function($__require,exports,module){var ceil=Math.ceil,floor=Math.floor;return module.exports=function(it){return isNaN(it=+it)?0:(it>0?floor:ceil)(it)},module.exports}),$__System.registerDynamic("2f",["16"],!0,function($__require,exports,module){var toInteger=$__require("16"),min=Math.min;return module.exports=function(it){return it>0?min(toInteger(it),9007199254740991):0},module.exports}),$__System.registerDynamic("30",["1c","22"],!0,function($__require,exports,module){var cof=$__require("1c"),TAG=$__require("22")("toStringTag"),ARG="Arguments"==cof(function(){return arguments}());return module.exports=function(it){var O,T,B;return void 0===it?"Undefined":null===it?"Null":"string"==typeof(T=(O=Object(it))[TAG])?T:ARG?cof(O):"Object"==(B=cof(O))&&"function"==typeof O.callee?"Arguments":B},module.exports}),$__System.registerDynamic("26",[],!0,function($__require,exports,module){return module.exports={},module.exports}),$__System.registerDynamic("31",["30","22","26","6"],!0,function($__require,exports,module){var classof=$__require("30"),ITERATOR=$__require("22")("iterator"),Iterators=$__require("26");return module.exports=$__require("6").getIteratorMethod=function(it){if(void 0!=it)return it[ITERATOR]||it["@@iterator"]||Iterators[classof(it)]},module.exports}),$__System.registerDynamic("32",["2a","2c","2e","2d","2f","31"],!0,function($__require,exports,module){var ctx=$__require("2a"),call=$__require("2c"),isArrayIter=$__require("2e"),anObject=$__require("2d"),toLength=$__require("2f"),getIterFn=$__require("31");return module.exports=function(iterable,entries,fn,that){var length,step,iterator,iterFn=getIterFn(iterable),f=ctx(fn,that,entries?2:1),index=0;if("function"!=typeof iterFn)throw TypeError(iterable+" is not iterable!");if(isArrayIter(iterFn))for(length=toLength(iterable.length);length>index;index++)entries?f(anObject(step=iterable[index])[0],step[1]):f(iterable[index]);else for(iterator=iterFn.call(iterable);!(step=iterator.next()).done;)call(iterator,f,step.value,entries)},module.exports}),$__System.registerDynamic("33",["12","34","2d","2a"],!0,function($__require,exports,module){var getDesc=$__require("12").getDesc,isObject=$__require("34"),anObject=$__require("2d"),check=function(O,proto){if(anObject(O),!isObject(proto)&&null!==proto)throw TypeError(proto+": can't set as prototype!")};return module.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(test,buggy,set){try{set=$__require("2a")(Function.call,getDesc(Object.prototype,"__proto__").set,2),set(test,[]),buggy=!(test instanceof Array)}catch(e){buggy=!0}return function(O,proto){return check(O,proto),buggy?O.__proto__=proto:set(O,proto),O}}({},!1):void 0),check:check},module.exports}),$__System.registerDynamic("35",[],!0,function($__require,exports,module){return module.exports=Object.is||function(x,y){return x===y?0!==x||1/x===1/y:x!=x&&y!=y},module.exports}),$__System.registerDynamic("2d",["34"],!0,function($__require,exports,module){var isObject=$__require("34");return module.exports=function(it){if(!isObject(it))throw TypeError(it+" is not an object!");return it},module.exports}),$__System.registerDynamic("36",["2d","37","22"],!0,function($__require,exports,module){var anObject=$__require("2d"),aFunction=$__require("37"),SPECIES=$__require("22")("species");return module.exports=function(O,D){var S,C=anObject(O).constructor;return void 0===C||void 0==(S=anObject(C)[SPECIES])?D:aFunction(S)},module.exports}),$__System.registerDynamic("37",[],!0,function($__require,exports,module){return module.exports=function(it){if("function"!=typeof it)throw TypeError(it+" is not a function!");return it},module.exports}),$__System.registerDynamic("2a",["37"],!0,function($__require,exports,module){var aFunction=$__require("37");return module.exports=function(fn,that,length){if(aFunction(fn),void 0===that)return fn;switch(length){case 1:return function(a){return fn.call(that,a)};case 2:return function(a,b){return fn.call(that,a,b)};case 3:return function(a,b,c){return fn.call(that,a,b,c)}}return function(){return fn.apply(that,arguments)}},module.exports}),$__System.registerDynamic("38",[],!0,function($__require,exports,module){return module.exports=function(fn,args,that){var un=void 0===that;switch(args.length){case 0:return un?fn():fn.call(that);case 1:return un?fn(args[0]):fn.call(that,args[0]);case 2:return un?fn(args[0],args[1]):fn.call(that,args[0],args[1]);case 3:return un?fn(args[0],args[1],args[2]):fn.call(that,args[0],args[1],args[2]);case 4:return un?fn(args[0],args[1],args[2],args[3]):fn.call(that,args[0],args[1],args[2],args[3])}return fn.apply(that,args)},module.exports}),$__System.registerDynamic("39",["29"],!0,function($__require,exports,module){return module.exports=$__require("29").document&&document.documentElement,module.exports}),$__System.registerDynamic("34",[],!0,function($__require,exports,module){return module.exports=function(it){return"object"==typeof it?null!==it:"function"==typeof it},module.exports}),$__System.registerDynamic("3a",["34","29"],!0,function($__require,exports,module){var isObject=$__require("34"),document=$__require("29").document,is=isObject(document)&&isObject(document.createElement);return module.exports=function(it){return is?document.createElement(it):{}},module.exports}),$__System.registerDynamic("3b",["2a","38","39","3a","29","1c","3c"],!0,function($__require,exports,module){return function(process){var defer,channel,port,ctx=$__require("2a"),invoke=$__require("38"),html=$__require("39"),cel=$__require("3a"),global=$__require("29"),process=global.process,setTask=global.setImmediate,clearTask=global.clearImmediate,MessageChannel=global.MessageChannel,counter=0,queue={},ONREADYSTATECHANGE="onreadystatechange",run=function(){var id=+this;if(queue.hasOwnProperty(id)){var fn=queue[id];delete queue[id],fn()}},listner=function(event){run.call(event.data)};setTask&&clearTask||(setTask=function(fn){for(var args=[],i=1;arguments.length>i;)args.push(arguments[i++]);return queue[++counter]=function(){invoke("function"==typeof fn?fn:Function(fn),args)},defer(counter),counter},clearTask=function(id){delete queue[id]},"process"==$__require("1c")(process)?defer=function(id){process.nextTick(ctx(run,id,1))}:MessageChannel?(channel=new MessageChannel,port=channel.port2,channel.port1.onmessage=listner,defer=ctx(port.postMessage,port,1)):global.addEventListener&&"function"==typeof postMessage&&!global.importScripts?(defer=function(id){global.postMessage(id+"","*")},global.addEventListener("message",listner,!1)):defer=ONREADYSTATECHANGE in cel("script")?function(id){html.appendChild(cel("script"))[ONREADYSTATECHANGE]=function(){html.removeChild(this),run.call(id)}}:function(id){setTimeout(ctx(run,id,1),0)}),module.exports={set:setTask,clear:clearTask}}($__require("3c")),module.exports}),$__System.registerDynamic("1c",[],!0,function($__require,exports,module){var toString={}.toString;return module.exports=function(it){return toString.call(it).slice(8,-1)},module.exports}),$__System.registerDynamic("3d",["29","3b","1c","3c"],!0,function($__require,exports,module){return function(process){var head,last,notify,global=$__require("29"),macrotask=$__require("3b").set,Observer=global.MutationObserver||global.WebKitMutationObserver,process=global.process,Promise=global.Promise,isNode="process"==$__require("1c")(process),flush=function(){var parent,domain,fn;for(isNode&&(parent=process.domain)&&(process.domain=null,parent.exit());head;)domain=head.domain,fn=head.fn,domain&&domain.enter(),fn(),domain&&domain.exit(),head=head.next;last=void 0,parent&&parent.enter()};if(isNode)notify=function(){process.nextTick(flush)};else if(Observer){var toggle=1,node=document.createTextNode("");new Observer(flush).observe(node,{characterData:!0}),notify=function(){node.data=toggle=-toggle}}else notify=Promise&&Promise.resolve?function(){Promise.resolve().then(flush)}:function(){macrotask.call(global,flush)};module.exports=function(fn){var task={fn:fn,next:void 0,domain:isNode&&process.domain};last&&(last.next=task),head||(head=task,notify()),last=task}}($__require("3c")),module.exports}),$__System.registerDynamic("1f",[],!0,function($__require,exports,module){return module.exports=function(bitmap,value){return{enumerable:!(1&bitmap),configurable:!(2&bitmap),writable:!(4&bitmap),value:value}},module.exports}),$__System.registerDynamic("21",["12","1f","3e"],!0,function($__require,exports,module){var $=$__require("12"),createDesc=$__require("1f");return module.exports=$__require("3e")?function(object,key,value){return $.setDesc(object,key,createDesc(1,value))}:function(object,key,value){return object[key]=value,object},module.exports}),$__System.registerDynamic("24",["21"],!0,function($__require,exports,module){return module.exports=$__require("21"),module.exports}),$__System.registerDynamic("3f",["24"],!0,function($__require,exports,module){var redefine=$__require("24");return module.exports=function(target,src){for(var key in src)redefine(target,key,src[key]);return target},module.exports}),$__System.registerDynamic("25",[],!0,function($__require,exports,module){var hasOwnProperty={}.hasOwnProperty;return module.exports=function(it,key){return hasOwnProperty.call(it,key)},module.exports}),$__System.registerDynamic("20",["12","25","22"],!0,function($__require,exports,module){var def=$__require("12").setDesc,has=$__require("25"),TAG=$__require("22")("toStringTag");return module.exports=function(it,tag,stat){it&&!has(it=stat?it:it.prototype,TAG)&&def(it,TAG,{configurable:!0,value:tag})},module.exports}),$__System.registerDynamic("12",[],!0,function($__require,exports,module){var $Object=Object;return module.exports={create:$Object.create,getProto:$Object.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:$Object.getOwnPropertyDescriptor,setDesc:$Object.defineProperty,setDescs:$Object.defineProperties,getKeys:$Object.keys,getNames:$Object.getOwnPropertyNames,getSymbols:$Object.getOwnPropertySymbols,each:[].forEach},module.exports}),$__System.registerDynamic("7",[],!0,function($__require,exports,module){return module.exports=function(exec){try{return!!exec()}catch(e){return!0}},module.exports}),$__System.registerDynamic("3e",["7"],!0,function($__require,exports,module){return module.exports=!$__require("7")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),module.exports}),$__System.registerDynamic("40",["6","12","3e","22"],!0,function($__require,exports,module){"use strict";var core=$__require("6"),$=$__require("12"),DESCRIPTORS=$__require("3e"),SPECIES=$__require("22")("species");return module.exports=function(KEY){var C=core[KEY];DESCRIPTORS&&C&&!C[SPECIES]&&$.setDesc(C,SPECIES,{configurable:!0,get:function(){return this}})},module.exports}),$__System.registerDynamic("41",["29"],!0,function($__require,exports,module){var global=this,global=$__require("29"),SHARED="__core-js_shared__",store=global[SHARED]||(global[SHARED]={});return module.exports=function(key){return store[key]||(store[key]={})},module.exports}),$__System.registerDynamic("42",[],!0,function($__require,exports,module){var id=0,px=Math.random();return module.exports=function(key){return"Symbol(".concat(void 0===key?"":key,")_",(++id+px).toString(36))},module.exports}),$__System.registerDynamic("29",[],!0,function($__require,exports,module){var global=this,global=module.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();return"number"==typeof __g&&(__g=global),module.exports}),$__System.registerDynamic("22",["41","42","29"],!0,function($__require,exports,module){var store=$__require("41")("wks"),uid=$__require("42"),Symbol=$__require("29").Symbol;return module.exports=function(name){return store[name]||(store[name]=Symbol&&Symbol[name]||(Symbol||uid)("Symbol."+name))},module.exports}),$__System.registerDynamic("43",["22"],!0,function($__require,exports,module){var ITERATOR=$__require("22")("iterator"),SAFE_CLOSING=!1;try{var riter=[7][ITERATOR]();riter.return=function(){SAFE_CLOSING=!0},Array.from(riter,function(){throw 2})}catch(e){}return module.exports=function(exec,skipClosing){if(!skipClosing&&!SAFE_CLOSING)return!1;var safe=!1;try{var arr=[7],iter=arr[ITERATOR]();iter.next=function(){safe=!0},arr[ITERATOR]=function(){return iter},exec(arr)}catch(e){}return safe},module.exports}),$__System.registerDynamic("44",[],!0,function($__require,exports,module){function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=setTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,clearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var currentQueue,process=module.exports={},queue=[],draining=!1,queueIndex=-1;return process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||setTimeout(drainQueue,0)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",
process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0},module.exports}),$__System.registerDynamic("45",["44"],!0,function($__require,exports,module){return module.exports=$__require("44"),module.exports}),$__System.registerDynamic("46",["45"],!0,function($__require,exports,module){return module.exports=$__System._nodeRequire?process:$__require("45"),module.exports}),$__System.registerDynamic("3c",["46"],!0,function($__require,exports,module){return module.exports=$__require("46"),module.exports}),$__System.registerDynamic("47",["12","23","29","2a","30","5","34","2d","37","2b","32","33","35","22","36","3d","3e","3f","20","40","6","43","3c"],!0,function($__require,exports,module){return function(process){"use strict";var Wrapper,$=$__require("12"),LIBRARY=$__require("23"),global=$__require("29"),ctx=$__require("2a"),classof=$__require("30"),$export=$__require("5"),isObject=$__require("34"),anObject=$__require("2d"),aFunction=$__require("37"),strictNew=$__require("2b"),forOf=$__require("32"),setProto=$__require("33").set,same=$__require("35"),SPECIES=$__require("22")("species"),speciesConstructor=$__require("36"),asap=$__require("3d"),PROMISE="Promise",process=global.process,isNode="process"==classof(process),P=global[PROMISE],testResolve=function(sub){var test=new P(function(){});return sub&&(test.constructor=Object),P.resolve(test)===test},USE_NATIVE=function(){function P2(x){var self=new P(x);return setProto(self,P2.prototype),self}var works=!1;try{if(works=P&&P.resolve&&testResolve(),setProto(P2,P),P2.prototype=$.create(P.prototype,{constructor:{value:P2}}),P2.resolve(5).then(function(){})instanceof P2||(works=!1),works&&$__require("3e")){var thenableThenGotten=!1;P.resolve($.setDesc({},"then",{get:function(){thenableThenGotten=!0}})),works=thenableThenGotten}}catch(e){works=!1}return works}(),sameConstructor=function(a,b){return!(!LIBRARY||a!==P||b!==Wrapper)||same(a,b)},getConstructor=function(C){var S=anObject(C)[SPECIES];return void 0!=S?S:C},isThenable=function(it){var then;return!(!isObject(it)||"function"!=typeof(then=it.then))&&then},PromiseCapability=function(C){var resolve,reject;this.promise=new C(function($$resolve,$$reject){if(void 0!==resolve||void 0!==reject)throw TypeError("Bad Promise constructor");resolve=$$resolve,reject=$$reject}),this.resolve=aFunction(resolve),this.reject=aFunction(reject)},perform=function(exec){try{exec()}catch(e){return{error:e}}},notify=function(record,isReject){if(!record.n){record.n=!0;var chain=record.c;asap(function(){for(var value=record.v,ok=1==record.s,i=0,run=function(reaction){var result,then,handler=ok?reaction.ok:reaction.fail,resolve=reaction.resolve,reject=reaction.reject;try{handler?(ok||(record.h=!0),result=handler===!0?value:handler(value),result===reaction.promise?reject(TypeError("Promise-chain cycle")):(then=isThenable(result))?then.call(result,resolve,reject):resolve(result)):reject(value)}catch(e){reject(e)}};chain.length>i;)run(chain[i++]);chain.length=0,record.n=!1,isReject&&setTimeout(function(){var handler,console,promise=record.p;isUnhandled(promise)&&(isNode?process.emit("unhandledRejection",value,promise):(handler=global.onunhandledrejection)?handler({promise:promise,reason:value}):(console=global.console)&&console.error&&console.error("Unhandled promise rejection",value)),record.a=void 0},1)})}},isUnhandled=function(promise){var reaction,record=promise._d,chain=record.a||record.c,i=0;if(record.h)return!1;for(;chain.length>i;)if(reaction=chain[i++],reaction.fail||!isUnhandled(reaction.promise))return!1;return!0},$reject=function(value){var record=this;record.d||(record.d=!0,record=record.r||record,record.v=value,record.s=2,record.a=record.c.slice(),notify(record,!0))},$resolve=function(value){var then,record=this;if(!record.d){record.d=!0,record=record.r||record;try{if(record.p===value)throw TypeError("Promise can't be resolved itself");(then=isThenable(value))?asap(function(){var wrapper={r:record,d:!1};try{then.call(value,ctx($resolve,wrapper,1),ctx($reject,wrapper,1))}catch(e){$reject.call(wrapper,e)}}):(record.v=value,record.s=1,notify(record,!1))}catch(e){$reject.call({r:record,d:!1},e)}}};USE_NATIVE||(P=function(executor){aFunction(executor);var record=this._d={p:strictNew(this,P,PROMISE),c:[],a:void 0,s:0,d:!1,v:void 0,h:!1,n:!1};try{executor(ctx($resolve,record,1),ctx($reject,record,1))}catch(err){$reject.call(record,err)}},$__require("3f")(P.prototype,{then:function(onFulfilled,onRejected){var reaction=new PromiseCapability(speciesConstructor(this,P)),promise=reaction.promise,record=this._d;return reaction.ok="function"!=typeof onFulfilled||onFulfilled,reaction.fail="function"==typeof onRejected&&onRejected,record.c.push(reaction),record.a&&record.a.push(reaction),record.s&&notify(record,!1),promise},catch:function(onRejected){return this.then(void 0,onRejected)}})),$export($export.G+$export.W+$export.F*!USE_NATIVE,{Promise:P}),$__require("20")(P,PROMISE),$__require("40")(PROMISE),Wrapper=$__require("6")[PROMISE],$export($export.S+$export.F*!USE_NATIVE,PROMISE,{reject:function(r){var capability=new PromiseCapability(this),$$reject=capability.reject;return $$reject(r),capability.promise}}),$export($export.S+$export.F*(!USE_NATIVE||testResolve(!0)),PROMISE,{resolve:function(x){if(x instanceof P&&sameConstructor(x.constructor,this))return x;var capability=new PromiseCapability(this),$$resolve=capability.resolve;return $$resolve(x),capability.promise}}),$export($export.S+$export.F*!(USE_NATIVE&&$__require("43")(function(iter){P.all(iter).catch(function(){})})),PROMISE,{all:function(iterable){var C=getConstructor(this),capability=new PromiseCapability(C),resolve=capability.resolve,reject=capability.reject,values=[],abrupt=perform(function(){forOf(iterable,!1,values.push,values);var remaining=values.length,results=Array(remaining);remaining?$.each.call(values,function(promise,index){var alreadyCalled=!1;C.resolve(promise).then(function(value){alreadyCalled||(alreadyCalled=!0,results[index]=value,--remaining||resolve(results))},reject)}):resolve(results)});return abrupt&&reject(abrupt.error),capability.promise},race:function(iterable){var C=getConstructor(this),capability=new PromiseCapability(C),reject=capability.reject,abrupt=perform(function(){forOf(iterable,!1,function(promise){C.resolve(promise).then(capability.resolve,reject)})});return abrupt&&reject(abrupt.error),capability.promise}})}($__require("3c")),module.exports}),$__System.registerDynamic("6",[],!0,function($__require,exports,module){var core=module.exports={version:"1.2.6"};return"number"==typeof __e&&(__e=core),module.exports}),$__System.registerDynamic("48",["14","17","28","47","6"],!0,function($__require,exports,module){return $__require("14"),$__require("17"),$__require("28"),$__require("47"),module.exports=$__require("6").Promise,module.exports}),$__System.registerDynamic("f",["48"],!0,function($__require,exports,module){return module.exports={default:$__require("48"),__esModule:!0},module.exports}),$__System.register("c",["f"],function(_export){function http(url){var core={ajax:function(method,url,args,headers){var promise=new _Promise(function(resolve,reject){var client=new XMLHttpRequest,uri="";if(args&&args.xml)uri=args.payload;else if(args&&("POST"===method||"PUT"===method)){var argcount=0;for(var key in args)args.hasOwnProperty(key)&&(argcount++&&(uri+="&"),uri+=encodeURIComponent(key)+"="+encodeURIComponent(args[key]))}if(client.open(method,url),headers)for(var i in headers)client.setRequestHeader(i,headers[i]);client.send(uri),client.onload=function(){this.status>=200&&this.status<300?resolve(this.response):reject(this.statusText)},client.onerror=function(){reject(this.statusText)}});return promise}};return{get:function(args,headers){return core.ajax("GET",url,args,headers)},post:function(args,headers){return core.ajax("POST",url,args,headers)},put:function(args,headers){return core.ajax("PUT",url,args,headers)},delete:function(args,headers){return core.ajax("DELETE",url,args,headers)}}}var _Promise;return{setters:[function(_f){_Promise=_f.default}],execute:function(){"use strict";_export("http",http)}}}),$__System.register("49",["d","e","f","c"],function(_export){var _createClass,_classCallCheck,_Promise,http,GoogleTranslate;return{setters:[function(_d){_createClass=_d.default},function(_e){_classCallCheck=_e.default},function(_f){_Promise=_f.default},function(_c){http=_c.http}],execute:function(){"use strict";GoogleTranslate=function(){function GoogleTranslate(key,srcLang,targetLang){_classCallCheck(this,GoogleTranslate),this.key=key,this.srcLang=srcLang,this.targetLang=targetLang,this.url="https://www.googleapis.com/language/translate/v2?key="+this.key}return _createClass(GoogleTranslate,[{key:"getTranslations",value:function(words){var _this=this,promise=new _Promise(function(resolve,reject){var promises=[];_this.url+="&source="+_this.srcLang+"&target="+_this.targetLang,words=_this.toList(words),promises=_this.getPromises(words),_Promise.all(promises).then(function(responses){var translations=_this.combineTranslations(responses),tMap=_this.mapTranslations(translations,words);resolve(tMap)}).catch(function(e){reject(e)})});return promise}},{key:"toList",value:function(words){var wordList=[];for(var word in words)wordList.push(word);return wordList}},{key:"getPromises",value:function(words){for(var i=0,promises=[],url="",limitedWords=[];i<words.length;){url=this.url,limitedWords=words.slice(i,i+128);for(var j in limitedWords)url+="&q="+limitedWords[j];promises.push(http(url).get()),i+=128}return promises}},{key:"combineTranslations",value:function(responses){var translations=[];for(var i in responses)translations=translations.concat(JSON.parse(responses[i]).data.translations);return translations}},{key:"mapTranslations",value:function(translations,words){var tMap={},i=0,translatedWords=translations;for(var word in words)tMap[words[word]]=translatedWords[i].translatedText,i++;return console.log(tMap),tMap}},{key:"translateSentence",value:function(text){var _this2=this,promise=new _Promise(function(resolve,reject){_this2.url+="&source="+_this2.srcLang+"&target="+_this2.targetLang,_this2.url+="&q="+text,http(_this2.url).get().then(function(data){resolve(JSON.parse(data).data.translations[0].translatedText)}).catch(function(e){reject(e)})});return promise}}]),GoogleTranslate}(),_export("GoogleTranslate",GoogleTranslate)}}}),$__System.register("1",["10","49","d","e","a","b"],function(_export){var BingTranslate,GoogleTranslate,_createClass,_classCallCheck,_Object$keys,YandexTranslate,ContentScript,MTWTranslator;return{setters:[function(_){BingTranslate=_.BingTranslate},function(_2){GoogleTranslate=_2.GoogleTranslate},function(_d){_createClass=_d.default},function(_e){_classCallCheck=_e.default},function(_a){_Object$keys=_a.default},function(_b){YandexTranslate=_b.YandexTranslate}],execute:function(){"use strict";ContentScript=function(){function ContentScript(){_classCallCheck(this,ContentScript),this.srcLang="",this.targetLang="",this.ngramMin=1,this.ngramMax=1,this.tMap={},this.filteredTMap={},this.selectedRegion={},this.wordToggles=0}return _createClass(ContentScript,[{key:"translate",value:function(){var _this=this;chrome.storage.local.get(null,function(res){if(res.activation===!0){_this.ngramMin=res.ngramMin,_this.ngramMax=res.ngramMax,_this.srcLang=res.sourceLanguage,_this.targetLanguage=res.targetLanguage,_this.userDefinedTranslations=JSON.parse(res.userDefinedTranslations),_this.translationProbability=res.translationProbability,_this.userBlacklistedWords=res.userBlacklistedWords,_this.translator=res.translatorService,_this.yandexTranslatorApiKey=res.yandexTranslatorApiKey,_this.bingTranslatorApiKey=res.bingTranslatorApiKey,_this.googleTranslatorApiKey=res.googleTranslatorApiKey,_this.translated=!0,_this.difficultyBuckets=res.difficultyBuckets,_this.learntWords=res.learntWords,_this.userDefinedOnly=res.userDefinedOnly,_this.stats=JSON.parse(res.stats),_this.wordToggles=res.wordToggles,_this.autoBlacklist=res.autoBlacklist;var blacklistWebsiteReg=new RegExp(res.blacklist);if(blacklistWebsiteReg.test(document.URL)&&"()"!==res.blacklist)console.log("[MTW] Blacklisted website");else if(res.doNotTranslate===!0)console.log("[MTW] Do Not Translate selected.");else if(""!==_this.srcLang&&""!==_this.targetLanguage||_this.userDefinedOnly!==!1){_this.injectCSS(res.translatedWordStyle);var filteredWords,countedWords=_this.getAllWords(_this.ngramMin,_this.ngramMax);if(_this.userDefinedOnly===!0){filteredWords=_this.filterToUserDefined(countedWords,_this.translationProbability,_this.userDefinedTranslations,_this.userBlacklistedWords);var tMap={};for(var word in filteredWords)tMap[word]=_this.userDefinedTranslations[word];_this.processTranslations(tMap,_this.userDefinedTranslations)}else{filteredWords=_this.filter(countedWords,_this.translationProbability,_this.userDefinedTranslations,_this.userBlacklistedWords);var translator=_this.getTranslator();translator.getTranslations(filteredWords).then(function(tMap){_this.processTranslations(tMap,_this.userDefinedTranslations)}).catch(function(e){console.error("[MTW]",e)})}}else console.log("[MTW] No active pattern. Please select a pattern in the options page.")}else console.log("[MTW] Switched off")})}},{key:"getTranslator",value:function(){var translatorObject={};switch(this.translator){case"Yandex":translatorObject=new YandexTranslate(this.yandexTranslatorApiKey,this.srcLang,this.targetLanguage);break;case"Bing":translatorObject=new BingTranslate(this.bingTranslatorApiKey,this.srcLang,this.targetLanguage);break;case"Google":translatorObject=new GoogleTranslate(this.googleTranslatorApiKey,this.srcLang,this.targetLanguage);break;default:console.error("No such translator supported")}return translatorObject}},{key:"injectCSS",value:function(cssStyle){try{var style=document.createElement("link");style.rel="stylesheet",style.type="text/css",style.href=chrome.extension.getURL("/assets/css/MTWStyles.css"),document.getElementsByTagName("head")[0].appendChild(style);var mtwStyle=document.createElement("style");document.head.appendChild(mtwStyle),mtwStyle.sheet.insertRule("span.mtwTranslatedWord {"+cssStyle+"}",0)}catch(e){console.debug(e)}}},{key:"getAllWords",value:function(ngramMin,ngramMax){var countedWords={},paragraphs=document.getElementsByTagName("p");console.log("Getting words from all "+paragraphs.length+" paragraphs");for(var i=0;i<paragraphs.length;i++)for(var words=paragraphs[i].innerText.split(/\s|,|[.()]|\d/g),j=0;j<words.length;j++)for(var b=ngramMin;b<=ngramMax;b++){var word=words.slice(j,j+b).join(" ");word in countedWords||(countedWords[word]=0),countedWords[word]+=1}return countedWords}},{key:"filterToUserDefined",value:function(countedWords,translationProbability,userDefinedTranslations,userBlacklistedWords){var a=(new RegExp(userBlacklistedWords),this.toList(userDefinedTranslations,function(word,count){return 1})),b=this.toList(countedWords,function(word,count){return 1}),countedWordsList=this.intersect(a,b);return this.toMap(countedWordsList)}},{key:"filter",value:function(countedWords,translationProbability,userDefinedTranslations,userBlacklistedWords){var blackListReg=new RegExp(userBlacklistedWords),punctuationReg=new RegExp(/[\.,\/#\!\$%\^&\*;:{}=\\\_`~()\?@\d\+\-]/g),countedWordsList=this.shuffle(this.toList(countedWords,function(word,count){return!!word&&word.length>=2&&""!==word&&!/\d/.test(word)&&word.charAt(0)!==word.charAt(0).toUpperCase()&&!(blackListReg.test(word.toLowerCase())&&"()"===blackListReg)&&!punctuationReg.test(word.toLowerCase())})),targetLength=Math.floor(_Object$keys(countedWordsList).length*translationProbability/100);return this.toMap(countedWordsList.slice(0,targetLength-1))}},{key:"containsIllegalCharacters",value:function(s){return/[0-9{}.,;:]/.test(s)}},{key:"processTranslations",value:function(translationMap,userDefinedTMap){var _this2=this,filteredTMap={};for(var w in translationMap)w===translationMap[w]||""===translationMap[w]||userDefinedTMap[w]||this.containsIllegalCharacters(translationMap[w])||(filteredTMap[w]=translationMap[w]);for(w in userDefinedTMap)w!==userDefinedTMap[w]&&(filteredTMap[w]=userDefinedTMap[w]);this.learntWords.length>2&&!function(){var learntWordsReg=new RegExp(_this2.learntWords);_Object$keys(filteredTMap).forEach(function(key){learntWordsReg.test(filteredTMap[key].toLowerCase())&&delete filteredTMap[key]})}(),this.filteredTMap=filteredTMap,chrome.storage.local.set({translatedWordsForQuiz:JSON.stringify(this.filteredTMap)});var numberOfTranslatedWords=_Object$keys(filteredTMap).length,numberOfTranslatedCharacters=0;_Object$keys(filteredTMap).forEach(function(e,i){numberOfTranslatedCharacters+=e.length}),this.stats.totalWordsTranslated+=numberOfTranslatedWords;var month=["January","February","March","April","May","June","July","August","September","October","November","December"],d=new Date,currentMonth=month[d.getMonth()];if(currentMonth in this.stats.translatorWiseWordCount||(this.stats.translatorWiseWordCount={},this.stats.translatorWiseWordCount[currentMonth]={Yandex:[0,0],Google:[0,0],Bing:[0,0]}),this.stats.translatorWiseWordCount[currentMonth][this.translator][0]+=numberOfTranslatedWords,this.stats.translatorWiseWordCount[currentMonth][this.translator][1]+=numberOfTranslatedCharacters,chrome.storage.local.set({stats:JSON.stringify(this.stats)}),chrome.storage.local.get(["savedPatterns"],function(result){for(var savedPatterns=JSON.parse(result.savedPatterns),i=0;i<savedPatterns.length;i++)if(savedPatterns[i][3]){savedPatterns[i][5]+=numberOfTranslatedWords,chrome.storage.local.set({savedPatterns:JSON.stringify(savedPatterns)});break}}),0!==_Object$keys(filteredTMap).length)for(var paragraphs=document.getElementsByTagName("p"),i=0;i<paragraphs.length;i++)this.deepHTMLReplacement(paragraphs[i],filteredTMap,this.invertMap(filteredTMap));for(var translatedWords=document.getElementsByClassName("mtwTranslatedWord"),_i=0;_i<translatedWords.length;_i++)translatedWords[_i].addEventListener("click",function(){_this2.toggleElement(event,_this2.wordToggles,_this2.autoBlacklist)},!1)}},{key:"toggleElement",value:function(event,wordToggles,autoBlacklist){var target=event.target,word=target.innerHTML,original=target.dataset.original,newword=word===target.dataset.translated?target.dataset.original:target.dataset.translated;autoBlacklist&&chrome.storage.local.get("toggleFrequency",function(data){if(data=JSON.parse(data.toggleFrequency),original in data)data[original]>wordToggles?(chrome.storage.local.get("userBlacklistedWords",function(result){var blacklistedWords=result.userBlacklistedWords.slice(1,-1).split("|");blacklistedWords.indexOf(original)===-1&&(blacklistedWords.push(original),chrome.storage.local.set({userBlacklistedWords:"("+blacklistedWords.join("|")+")"}))}),delete data.original):data[original]+=1;else if(_Object$keys(data).length>=100){var min=1/0,lowest="";for(var _word in data)data[_word]<min&&(min=data[_word],lowest=_word);delete data[lowest],data[original]=1}else data[original]=1;chrome.storage.local.set({toggleFrequency:JSON.stringify(data)})}),target.innerHTML=newword}},{key:"deepHTMLReplacement",value:function(node,tMap,iTMap){var badTags=["TEXTAREA","INPUT","SCRIPT","CODE","A","SPAN"];if(node.nodeType===Node.TEXT_NODE){var newNodeValue=this.replaceAll(node.nodeValue,tMap);if(newNodeValue!==node.nodeValue){node.nodeValue=newNodeValue;var parent=node.parentNode;parent.innerHTML=this.replaceAll(parent.innerHTML,iTMap)}}else if(node.nodeType===Node.ELEMENT_NODE&&badTags.indexOf(node.tagName)<=-1)for(var innerNodes=node.childNodes,index=0;index<innerNodes.length-1;index++)this.deepHTMLReplacement(innerNodes[index],tMap,iTMap)}},{key:"replaceAll",value:function(text,translationMap){var _this3=this,rExp="",sortedSourceWords=_Object$keys(translationMap).sort(function(w1,w2){return w2.length-w1.length});sortedSourceWords.forEach(function(sourceWord){rExp+="(\\s"+_this3.escapeRegExp(sourceWord)+"\\s)|"}),rExp=rExp.substring(0,rExp.length-1);var regExp=new RegExp(rExp,"gm"),newText=text.replace(regExp,function(m){return null!==translationMap[m.substring(1,m.length-1)]?" "+translationMap[m.substring(1,m.length-1)]+" ":" "+m+" "});return/^\s*$/.test(newText)?text:newText}},{key:"invertMap",value:function(map){var parsedDifficultyBuckets=JSON.parse(this.difficultyBuckets),iMap={};for(var e in map){if(iMap[map[e]]='<span data-sl="'+this.srcLang+'" data-tl="'+this.targetLanguage+'" data-query="'+e+'" data-original="'+e+'" data-translated="'+map[e],map[e]in parsedDifficultyBuckets){var wordDifficultyLevel=parsedDifficultyBuckets[map[e]];iMap[map[e]]=iMap[map[e]]+'" class="mtwTranslatedWord'+wordDifficultyLevel+'"'}else iMap[map[e]]=iMap[map[e]]+'" class="mtwTranslatedWord"';iMap[map[e]]=iMap[map[e]]+">"+map[e]+"</span>"}return iMap}},{key:"toggleAllElements",value:function(){this.translated=!this.translated;for(var words=document.getElementsByClassName("mtwTranslatedWord"),i=0;i<words.length;i++){var word=words[i];isNaN(word.innerText)&&(word.innerText=this.translated?word.dataset.translated:word.dataset.original)}}},{key:"escapeRegExp",value:function(str){return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}},{key:"toList",value:function(map,filter){var list=[];for(var item in map)filter(item,map[item])&&list.push(item);return list}},{key:"shuffle",value:function(o){for(var j,x,i=o.length;i;j=Math.floor(Math.random()*i),x=o[--i],o[i]=o[j],o[j]=x);return o}},{key:"toMap",value:function(list){for(var map={},i=0;i<list.length;i++)map[list[i]]=1;return map}},{key:"intersect",value:function(){var i,shortest,nShortest,n,len,nOthers,ret=[],obj={};for(nOthers=arguments.length-1,nShortest=arguments[0].length,shortest=0,i=0;i<=nOthers;i++)n=arguments[i].length,n<nShortest&&(shortest=i,nShortest=n);for(i=0;i<=nOthers;i++){n=i===shortest?0:i||shortest,len=arguments[n].length;for(var j=0;j<len;j++){var elem=arguments[n][j];obj[elem]===i-1?i===nOthers?(ret.push(elem),obj[elem]=0):obj[elem]=i:0===i&&(obj[elem]=0)}}return ret}}]),ContentScript}(),_export("ContentScript",ContentScript),MTWTranslator=new ContentScript,MTWTranslator.translate(),chrome.runtime.onMessage.addListener(function(request,sender,sendResponse){"toggleAllElements"===request.type?MTWTranslator.toggleAllElements():"getTranslatedWords"===request.type?("storeSelection"===request.action&&(MTWTranslator.selectedRegion=window.getSelection().getRangeAt(0)),sendResponse({translatedWords:MTWTranslator.filteredTMap})):(request.type="showTranslatedSentence")&&!function(){var handler=function handler(e){this.removeEventListener("click",handler),anchor.parentNode.removeChild(anchor)},anchor=document.createElement("span"),dummy=document.createElement("span");dummy.innerText=request.data,dummy.classList.add("popover"),dummy.classList.add("noselect"),anchor.appendChild(dummy),anchor.classList.add("anchor"),MTWTranslator.selectedRegion.insertNode(anchor),window.addEventListener("click",handler)}()})}}})})(function(factory){factory()});